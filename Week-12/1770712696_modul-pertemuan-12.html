<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modul Praktikum Pertemuan 12 - File Handling</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; overflow-x: hidden; }
        .book-container { max-width: 900px; margin: 50px auto; }
        .book { background: #fff; border-radius: 15px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); overflow: hidden; }
        .controls { position: fixed; top: 20px; right: 20px; z-index: 1000; display: flex; gap: 10px; }
        .control-btn { background: rgba(255,255,255,0.9); border: none; padding: 10px 15px; border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: 500; transition: all 0.3s ease; }
        .control-btn:hover { background: #fff; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

        /* Cover - File Theme (Orange/Amber) */
        .cover-page { background: linear-gradient(135deg, #e65100 0%, #ff9800 50%, #ffcc80 100%); color: white; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; text-align: center; position: relative; overflow: hidden; }
        .cover-page::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(ellipse at 30% 20%, rgba(255,152,0,0.3) 0%, transparent 50%), radial-gradient(ellipse at 70% 60%, rgba(230,81,0,0.2) 0%, transparent 50%); z-index: 1; }
        .cover-page::after { content: ''; position: absolute; inset: 0; background-image: radial-gradient(2px 2px at 10% 15%, rgba(255,255,255,0.15) 50%, transparent 50%), radial-gradient(2px 2px at 85% 25%, rgba(255,255,255,0.1) 50%, transparent 50%), radial-gradient(1px 1px at 55% 65%, rgba(255,255,255,0.12) 50%, transparent 50%); z-index: 1; animation: twinkle 4s ease-in-out infinite alternate; }
        @keyframes twinkle { 0% { opacity: 0.6; } 100% { opacity: 1; } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes pulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(255,152,0,0.4); } 50% { box-shadow: 0 0 20px 10px rgba(255,152,0,0.1); } }
        .cover-content { position: relative; z-index: 2; padding: 50px 40px; }
        .cover-top-bar { display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 35px; animation: fadeInUp 0.8s ease-out; }
        .cover-top-bar .bar-line { flex: 1; max-width: 120px; height: 1px; background: linear-gradient(90deg, transparent, rgba(255,204,128,0.6), transparent); }
        .cover-university-badge { display: inline-flex; align-items: center; gap: 12px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); padding: 10px 24px; border-radius: 50px; font-size: 14px; letter-spacing: 2px; text-transform: uppercase; }
        .cover-icon { font-size: 80px; margin-bottom: 20px; animation: fadeInUp 0.9s ease-out, float 3s ease-in-out infinite; }
        .cover-label { display: inline-block; background: linear-gradient(135deg, rgba(255,152,0,0.3), rgba(255,152,0,0.1)); border: 1px solid rgba(255,204,128,0.5); padding: 8px 28px; border-radius: 6px; font-size: 13px; letter-spacing: 4px; text-transform: uppercase; color: #fff3e0; margin-bottom: 25px; animation: fadeInUp 1s ease-out; }
        .cover-main-title { font-size: 2.6em; font-weight: 800; margin-bottom: 8px; text-shadow: 0 4px 15px rgba(0,0,0,0.3); letter-spacing: 2px; line-height: 1.2; animation: fadeInUp 1.1s ease-out; }
        .cover-main-title .highlight { color: #fff3e0; }
        .cover-course-name { font-size: 1.4em; font-weight: 300; margin-bottom: 35px; opacity: 0.9; animation: fadeInUp 1.2s ease-out; }
        .cover-meeting-badge { display: inline-flex; align-items: center; gap: 15px; background: linear-gradient(135deg, #ff9800, #e65100); color: white; padding: 14px 40px; border-radius: 50px; font-size: 1.3em; font-weight: 700; margin-bottom: 15px; box-shadow: 0 8px 30px rgba(255,152,0,0.4); animation: fadeInUp 1.3s ease-out, pulse 2s infinite; border: 2px solid rgba(255,255,255,0.2); }
        .cover-meeting-badge .meeting-number { background: rgba(255,255,255,0.2); width: 38px; height: 38px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; }
        .cover-topic { font-size: 1.1em; color: rgba(255,255,255,0.85); margin-bottom: 40px; max-width: 600px; margin-left: auto; margin-right: auto; line-height: 1.6; animation: fadeInUp 1.4s ease-out; }
        .cover-info-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 650px; margin: 0 auto; animation: fadeInUp 1.5s ease-out; }
        .cover-info-card { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 18px 12px; transition: all 0.3s ease; }
        .cover-info-card:hover { background: rgba(255,255,255,0.12); border-color: rgba(255,204,128,0.5); transform: translateY(-4px); }
        .cover-info-card .card-icon { font-size: 24px; margin-bottom: 8px; }
        .cover-info-card .card-label { font-size: 10px; text-transform: uppercase; letter-spacing: 1.5px; color: #fff3e0; margin-bottom: 4px; }
        .cover-info-card .card-value { font-size: 13px; font-weight: 500; }

        /* Page Styles */
        .page-content { padding: 60px 50px; line-height: 1.8; font-size: 16px; color: #333; }
        .page-number { text-align: right; font-size: 14px; color: #999; margin-top: 40px; padding-top: 15px; border-top: 1px solid #eee; }
        .section-title { color: #e65100; font-size: 1.9em; font-weight: 700; margin: 40px 0 20px 0; position: relative; }
        .section-title::before { content: ''; position: absolute; left: 0; bottom: -5px; width: 60px; height: 3px; background: linear-gradient(90deg, #e65100, #ff9800); }
        .subsection-title { color: #ff9800; font-size: 1.35em; font-weight: 600; margin: 30px 0 15px 0; }
        .objective-list, .content-list { margin: 20px 0; padding-left: 20px; }
        .objective-list li, .content-list li { margin: 10px 0; position: relative; }
        .objective-list li::before { content: '\1F3AF'; position: absolute; left: -25px; }
        .content-list li::before { content: '\1F4CB'; position: absolute; left: -25px; }
        .learning-outcomes { background: linear-gradient(135deg, #fff3e0 0%, #fff 100%); padding: 30px; border-radius: 15px; margin: 30px 0; border-left: 5px solid #ff9800; box-shadow: 0 5px 15px rgba(255,152,0,0.1); }
        .lab-setup { background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); padding: 30px; border-radius: 15px; margin: 30px 0; border-left: 5px solid #e65100; }
        .warning-box { background: #fff3cd; border-left: 5px solid #f39c12; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .warning-box::before { content: '\26A0\FE0F'; margin-right: 10px; }
        .info-box { background: #e3f2fd; border-left: 5px solid #2196f3; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .info-box::before { content: '\2139\FE0F'; margin-right: 10px; }
        .success-box { background: #e8f5e9; border-left: 5px solid #4caf50; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .success-box::before { content: '\2705'; margin-right: 10px; }
        .danger-box { background: #ffebee; border-left: 5px solid #f44336; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .danger-box::before { content: '\274C'; margin-right: 10px; }
        .step-item { background: #fff; border: 1px solid #e0e0e0; border-radius: 10px; padding: 25px; margin: 15px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
        .step-number { background: linear-gradient(135deg, #e65100, #ff9800); color: white; width: 30px; height: 30px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-weight: 600; margin-right: 15px; }
        .step-title { color: #e65100; font-weight: 600; font-size: 1.1em; margin-bottom: 10px; }

        /* Code Block */
        .code-block { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 12px; padding: 20px; font-family: 'Fira Code', 'Consolas', monospace; font-size: 13px; margin: 20px 0; overflow-x: auto; color: #e2e8f0; box-shadow: 0 10px 25px rgba(0,0,0,0.2); position: relative; }
        .code-block::before { content: ''; position: absolute; top: 12px; left: 15px; width: 10px; height: 10px; background: #ff5f57; border-radius: 50%; box-shadow: 16px 0 0 #ffbd2e, 32px 0 0 #28ca42; }
        .code-block code { display: block; margin-top: 10px; white-space: pre; line-height: 1.6; }
        .code-label { display: inline-block; background: linear-gradient(135deg, #e65100, #ff9800); color: white; padding: 3px 10px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-bottom: 8px; }
        .code-label.js { background: linear-gradient(135deg, #f7df1e, #d4a800); color: #000; }
        .code-label.php { background: linear-gradient(135deg, #8892be, #4f5b93); }
        .code-label.sql { background: linear-gradient(135deg, #f29111, #e67e00); color: #fff; }
        .file-tree { display: block; white-space: pre; line-height: 1.8; overflow-x: auto; }

        /* Syntax Highlighting */
        .tag { color: #ff79c6; }
        .attr { color: #50fa7b; }
        .value { color: #f1fa8c; }
        .keyword { color: #ff79c6; }
        .string { color: #50fa7b; }
        .number { color: #bd93f9; }
        .comment { color: #6272a4; font-style: italic; }
        .function { color: #8be9fd; }
        .php-var { color: #ffb86c; }
        .method { color: #50fa7b; }
        .js-keyword { color: #ff79c6; }
        .js-string { color: #f1fa8c; }
        .js-func { color: #8be9fd; }

        /* Table */
        .table-container { overflow-x: auto; margin: 20px 0; }
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #e0e0e0; }
        th { background: linear-gradient(135deg, #e65100, #ff9800); color: white; font-weight: 600; }
        tr:hover { background: #fff3e0; }

        /* Upload Flow Diagram */
        .upload-flow { display: flex; justify-content: center; align-items: center; gap: 15px; flex-wrap: wrap; margin: 25px 0; padding: 30px; background: linear-gradient(135deg, #f8f9fa, #fff); border-radius: 15px; border: 2px solid #ff9800; }
        .upload-step { text-align: center; padding: 20px; border-radius: 12px; background: white; box-shadow: 0 3px 15px rgba(0,0,0,0.1); min-width: 100px; }
        .upload-step .step-icon { font-size: 32px; margin-bottom: 8px; }
        .upload-step .step-label { font-size: 11px; font-weight: 600; color: #333; }
        .upload-arrow { font-size: 24px; color: #ff9800; }

        /* File Type Cards */
        .file-types { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 25px 0; }
        .file-type-card { background: white; border-radius: 12px; padding: 20px; text-align: center; box-shadow: 0 3px 15px rgba(0,0,0,0.1); border-top: 4px solid #ff9800; transition: transform 0.3s; }
        .file-type-card:hover { transform: translateY(-5px); }
        .file-type-card .file-icon { font-size: 36px; margin-bottom: 10px; }
        .file-type-card .file-ext { font-weight: 600; color: #e65100; }
        .file-type-card .file-mime { font-size: 11px; color: #666; }

        /* Project Card */
        .project-card { background: linear-gradient(135deg, #fff3e0, #fff); border-radius: 15px; padding: 30px; margin: 25px 0; border: 2px solid #ffe0b2; }
        .project-card h3 { color: #e65100; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div class="controls">
        <button class="control-btn" onclick="scrollToTop()">&#8593; Atas</button>
        <button class="control-btn" onclick="scrollToBottom()">&#8595; Bawah</button>
    </div>

    <div class="book-container">
        <div class="book">

            <!-- COVER PAGE -->
            <div class="cover-page">
                <div class="cover-content">
                    <div class="cover-top-bar">
                        <div class="bar-line"></div>
                        <div class="cover-university-badge">
                            <span>&#127891;</span>
                            <span>Universitas Tidar</span>
                        </div>
                        <div class="bar-line"></div>
                    </div>

                    <div class="cover-icon">&#128193;</div>

                    <div class="cover-label">Modul Praktikum</div>

                    <h1 class="cover-main-title">
                        PRAKTIKUM<br>
                        <span class="highlight">APLIKASI WEB</span>
                    </h1>

                    <p class="cover-course-name">Program Studi Teknologi Informasi</p>

                    <div class="cover-meeting-badge">
                        <span class="meeting-number">12</span>
                        <span>PERTEMUAN KEDUABELAS</span>
                    </div>

                    <p class="cover-topic">
                        File Handling di PHP<br>
                        <em>Upload, Download & Manajemen File</em>
                    </p>

                    <div class="cover-info-cards">
                        <div class="cover-info-card">
                            <div class="card-icon">&#128228;</div>
                            <div class="card-label">Topik</div>
                            <div class="card-value">File Upload</div>
                        </div>
                        <div class="cover-info-card">
                            <div class="card-icon">&#128229;</div>
                            <div class="card-label">Fokus</div>
                            <div class="card-value">File Download</div>
                        </div>
                        <div class="cover-info-card">
                            <div class="card-icon">&#128737;</div>
                            <div class="card-label">Keamanan</div>
                            <div class="card-value">Validation</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PAGE 1: PENDAHULUAN -->
            <div class="page-content">
                <h2 class="section-title">&#128218; PENDAHULUAN</h2>

                <div class="learning-outcomes">
                    <h3 style="color: #e65100; margin-bottom: 15px;">&#127919; Capaian Pembelajaran</h3>
                    <p>Setelah menyelesaikan praktikum ini, mahasiswa mampu:</p>
                    <ul class="objective-list">
                        <li>Memahami konsep file handling dalam PHP</li>
                        <li>Mengimplementasikan fitur upload file dengan validasi</li>
                        <li>Membuat fitur download file yang aman</li>
                        <li>Mengelola file (rename, delete, move)</li>
                        <li>Menampilkan gambar yang diupload</li>
                    </ul>
                </div>

                <h3 class="subsection-title">Konsep Dasar File Upload</h3>

                <div class="upload-flow">
                    <div class="upload-step">
                        <div class="step-icon">&#128196;</div>
                        <div class="step-label">User Pilih<br>File</div>
                    </div>
                    <div class="upload-arrow">&#10140;</div>
                    <div class="upload-step">
                        <div class="step-icon">&#128228;</div>
                        <div class="step-label">Form Submit<br>(enctype)</div>
                    </div>
                    <div class="upload-arrow">&#10140;</div>
                    <div class="upload-step">
                        <div class="step-icon">&#128269;</div>
                        <div class="step-label">Validasi<br>Server</div>
                    </div>
                    <div class="upload-arrow">&#10140;</div>
                    <div class="upload-step">
                        <div class="step-icon">&#128190;</div>
                        <div class="step-label">Simpan ke<br>Folder</div>
                    </div>
                    <div class="upload-arrow">&#10140;</div>
                    <div class="upload-step">
                        <div class="step-icon">&#128451;</div>
                        <div class="step-label">Simpan Path<br>ke Database</div>
                    </div>
                </div>

                <h3 class="subsection-title">Tipe File yang Umum</h3>

                <div class="file-types">
                    <div class="file-type-card">
                        <div class="file-icon">&#128247;</div>
                        <div class="file-ext">.jpg, .png</div>
                        <div class="file-mime">image/jpeg, image/png</div>
                    </div>
                    <div class="file-type-card">
                        <div class="file-icon">&#128196;</div>
                        <div class="file-ext">.pdf</div>
                        <div class="file-mime">application/pdf</div>
                    </div>
                    <div class="file-type-card">
                        <div class="file-icon">&#128209;</div>
                        <div class="file-ext">.doc, .docx</div>
                        <div class="file-mime">application/msword</div>
                    </div>
                    <div class="file-type-card">
                        <div class="file-icon">&#128202;</div>
                        <div class="file-ext">.xls, .xlsx</div>
                        <div class="file-mime">application/excel</div>
                    </div>
                </div>

                <div class="page-number">Halaman 1</div>
            </div>

            <!-- PAGE 2: STRUKTUR UPDATE -->
            <div class="page-content">
                <h3 class="subsection-title">Update Struktur Project</h3>

                <div class="code-block">
                    <span class="code-label">Struktur Folder dengan File Upload</span>
                    <code class="file-tree">project-mvc/
├── config/
│   └── database.php
├── models/
│   ├── Mahasiswa.php          <span class="comment"># Update: tambah field foto</span>
│   └── User.php
├── controllers/
│   ├── MahasiswaController.php <span class="comment"># Update: handle upload</span>
│   └── AuthController.php
├── views/
│   ├── layouts/
│   │   └── main.php
│   └── mahasiswa/
│       ├── index.php          <span class="comment"># Update: tampilkan foto</span>
│       ├── create.php         <span class="comment"># Update: input file</span>
│       └── edit.php           <span class="comment"># Update: edit foto</span>
├── includes/
│   ├── validation.php
│   ├── auth.php
│   └── <span style="color: #50fa7b;">FileHandler.php</span>       <span class="comment"># BARU: Class upload</span>
├── <span style="color: #50fa7b;">uploads/</span>                    <span class="comment"># BARU: Folder upload</span>
│   ├── <span style="color: #50fa7b;">mahasiswa/</span>             <span class="comment"># Foto mahasiswa</span>
│   └── <span style="color: #50fa7b;">documents/</span>             <span class="comment"># Dokumen lainnya</span>
├── public/
│   ├── css/
│   └── js/
└── index.php</code>
                </div>

                <h3 class="subsection-title">Update Tabel Mahasiswa</h3>

                <div class="code-block">
                    <span class="code-label sql">SQL - Tambah Kolom Foto</span>
                    <code><span class="comment">-- Jalankan di phpMyAdmin</span>

<span class="keyword">ALTER TABLE</span> mahasiswa
<span class="keyword">ADD COLUMN</span> foto <span class="function">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NULL AFTER</span> jurusan;

<span class="comment">-- Atau buat tabel dokumen terpisah (opsional)</span>
<span class="keyword">CREATE TABLE</span> dokumen (
    id <span class="function">INT</span> <span class="keyword">PRIMARY KEY AUTO_INCREMENT</span>,
    mahasiswa_id <span class="function">INT</span> <span class="keyword">NOT NULL</span>,
    nama_file <span class="function">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,
    path <span class="function">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,
    tipe <span class="function">VARCHAR</span>(<span class="number">100</span>),
    ukuran <span class="function">INT</span>,
    uploaded_at <span class="function">TIMESTAMP</span> <span class="keyword">DEFAULT CURRENT_TIMESTAMP</span>,
    <span class="keyword">FOREIGN KEY</span> (mahasiswa_id) <span class="keyword">REFERENCES</span> mahasiswa(id) <span class="keyword">ON DELETE CASCADE</span>
);</code>
                </div>

                <div class="warning-box">
                    <strong>Persiapan Folder Upload:</strong>
                    <p style="margin-top: 8px;">Buat folder <code>uploads/mahasiswa</code> dan pastikan permission-nya writable (chmod 755 atau 777 di Linux).</p>
                </div>

                <div class="page-number">Halaman 2</div>
            </div>

            <!-- PAGE 3: $_FILES ARRAY -->
            <div class="page-content">
                <h2 class="section-title">&#128230; MEMAHAMI $_FILES</h2>

                <p>Ketika form dengan <code>enctype="multipart/form-data"</code> di-submit, PHP menyimpan informasi file di superglobal <code>$_FILES</code>.</p>

                <div class="code-block">
                    <span class="code-label">Contoh Form Upload</span>
                    <code><span class="tag">&lt;form</span> <span class="attr">action</span>=<span class="value">"upload.php"</span> <span class="attr">method</span>=<span class="value">"POST"</span> <span class="attr">enctype</span>=<span class="value">"multipart/form-data"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"file"</span> <span class="attr">name</span>=<span class="value">"foto"</span> <span class="attr">accept</span>=<span class="value">"image/*"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;button</span> <span class="attr">type</span>=<span class="value">"submit"</span><span class="tag">&gt;</span>Upload<span class="tag">&lt;/button&gt;</span>
<span class="tag">&lt;/form&gt;</span></code>
                </div>

                <h3 class="subsection-title">Struktur Array $_FILES</h3>

                <div class="code-block">
                    <span class="code-label php">Isi $_FILES['foto']</span>
                    <code><span class="php-var">$_FILES</span>[<span class="string">'foto'</span>] = [
    <span class="string">'name'</span>     => <span class="string">'profile.jpg'</span>,     <span class="comment">// Nama file asli</span>
    <span class="string">'type'</span>     => <span class="string">'image/jpeg'</span>,       <span class="comment">// MIME type</span>
    <span class="string">'tmp_name'</span> => <span class="string">'/tmp/phpXXXXXX'</span>,   <span class="comment">// Lokasi temporary</span>
    <span class="string">'error'</span>    => <span class="number">0</span>,                   <span class="comment">// Kode error (0 = sukses)</span>
    <span class="string">'size'</span>     => <span class="number">123456</span>               <span class="comment">// Ukuran dalam bytes</span>
];</code>
                </div>

                <h3 class="subsection-title">Kode Error Upload</h3>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Konstanta</th><th>Nilai</th><th>Keterangan</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>UPLOAD_ERR_OK</td><td>0</td><td>Upload berhasil</td></tr>
                            <tr><td>UPLOAD_ERR_INI_SIZE</td><td>1</td><td>Melebihi upload_max_filesize di php.ini</td></tr>
                            <tr><td>UPLOAD_ERR_FORM_SIZE</td><td>2</td><td>Melebihi MAX_FILE_SIZE di form</td></tr>
                            <tr><td>UPLOAD_ERR_PARTIAL</td><td>3</td><td>File hanya terupload sebagian</td></tr>
                            <tr><td>UPLOAD_ERR_NO_FILE</td><td>4</td><td>Tidak ada file yang diupload</td></tr>
                            <tr><td>UPLOAD_ERR_NO_TMP_DIR</td><td>6</td><td>Folder temporary tidak ada</td></tr>
                            <tr><td>UPLOAD_ERR_CANT_WRITE</td><td>7</td><td>Gagal menulis ke disk</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="page-number">Halaman 3</div>
            </div>

            <!-- PAGE 4: FILE HANDLER CLASS -->
            <div class="page-content">
                <h3 class="subsection-title">1. Class FileHandler</h3>

                <div class="code-block">
                    <span class="code-label php">includes/FileHandler.php</span>
                    <code><span class="tag">&lt;?php</span>
<span class="comment">/**
 * Class untuk menangani upload dan manajemen file
 */</span>
<span class="keyword">class</span> <span class="function">FileHandler</span> {
    <span class="keyword">private</span> <span class="php-var">$uploadDir</span>;
    <span class="keyword">private</span> <span class="php-var">$allowedTypes</span>;
    <span class="keyword">private</span> <span class="php-var">$maxSize</span>;
    <span class="keyword">private</span> <span class="php-var">$errors</span> = [];

    <span class="keyword">public function</span> <span class="method">__construct</span>(
        <span class="php-var">$uploadDir</span> = <span class="string">'uploads/'</span>,
        <span class="php-var">$allowedTypes</span> = [<span class="string">'image/jpeg'</span>, <span class="string">'image/png'</span>, <span class="string">'image/gif'</span>],
        <span class="php-var">$maxSize</span> = <span class="number">2097152</span> <span class="comment">// 2MB</span>
    ) {
        <span class="php-var">$this</span>->uploadDir = <span class="function">rtrim</span>(<span class="php-var">$uploadDir</span>, <span class="string">'/'</span>) . <span class="string">'/'</span>;
        <span class="php-var">$this</span>->allowedTypes = <span class="php-var">$allowedTypes</span>;
        <span class="php-var">$this</span>->maxSize = <span class="php-var">$maxSize</span>;

        <span class="comment">// Buat folder jika belum ada</span>
        <span class="keyword">if</span> (!<span class="function">is_dir</span>(<span class="php-var">$this</span>->uploadDir)) {
            <span class="function">mkdir</span>(<span class="php-var">$this</span>->uploadDir, <span class="number">0755</span>, <span class="keyword">true</span>);
        }
    }

    <span class="comment">/**
     * Upload file
     * @param array $file - $_FILES['fieldname']
     * @return string|false - nama file baru atau false jika gagal
     */</span>
    <span class="keyword">public function</span> <span class="method">upload</span>(<span class="php-var">$file</span>) {
        <span class="comment">// Reset errors</span>
        <span class="php-var">$this</span>->errors = [];

        <span class="comment">// Cek apakah ada file</span>
        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="php-var">$file</span>) || <span class="php-var">$file</span>[<span class="string">'error'</span>] === UPLOAD_ERR_NO_FILE) {
            <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// Tidak ada file (opsional)</span>
        }

        <span class="comment">// Cek error upload</span>
        <span class="keyword">if</span> (<span class="php-var">$file</span>[<span class="string">'error'</span>] !== UPLOAD_ERR_OK) {
            <span class="php-var">$this</span>->errors[] = <span class="php-var">$this</span>-><span class="method">getErrorMessage</span>(<span class="php-var">$file</span>[<span class="string">'error'</span>]);
            <span class="keyword">return</span> <span class="keyword">false</span>;
        }

        <span class="comment">// Validasi file</span>
        <span class="keyword">if</span> (!<span class="php-var">$this</span>-><span class="method">validate</span>(<span class="php-var">$file</span>)) {
            <span class="keyword">return</span> <span class="keyword">false</span>;
        }

        <span class="comment">// Generate nama file unik</span>
        <span class="php-var">$newFileName</span> = <span class="php-var">$this</span>-><span class="method">generateFileName</span>(<span class="php-var">$file</span>[<span class="string">'name'</span>]);
        <span class="php-var">$destination</span> = <span class="php-var">$this</span>->uploadDir . <span class="php-var">$newFileName</span>;

        <span class="comment">// Pindahkan file dari temp ke folder tujuan</span>
        <span class="keyword">if</span> (<span class="function">move_uploaded_file</span>(<span class="php-var">$file</span>[<span class="string">'tmp_name'</span>], <span class="php-var">$destination</span>)) {
            <span class="keyword">return</span> <span class="php-var">$newFileName</span>;
        }

        <span class="php-var">$this</span>->errors[] = <span class="string">'Gagal menyimpan file'</span>;
        <span class="keyword">return</span> <span class="keyword">false</span>;
    }

    <span class="comment">// ... lanjut di halaman berikutnya</span></code>
                </div>

                <div class="page-number">Halaman 4</div>
            </div>

            <!-- PAGE 5: FILE HANDLER LANJUTAN -->
            <div class="page-content">
                <h3 class="subsection-title">FileHandler (Lanjutan)</h3>

                <div class="code-block">
                    <span class="code-label php">includes/FileHandler.php (lanjutan)</span>
                    <code>    <span class="comment">/**
     * Validasi file
     */</span>
    <span class="keyword">private function</span> <span class="method">validate</span>(<span class="php-var">$file</span>) {
        <span class="php-var">$valid</span> = <span class="keyword">true</span>;

        <span class="comment">// Cek ukuran file</span>
        <span class="keyword">if</span> (<span class="php-var">$file</span>[<span class="string">'size'</span>] > <span class="php-var">$this</span>->maxSize) {
            <span class="php-var">$this</span>->errors[] = <span class="string">'Ukuran file maksimal '</span> .
                <span class="php-var">$this</span>-><span class="method">formatSize</span>(<span class="php-var">$this</span>->maxSize);
            <span class="php-var">$valid</span> = <span class="keyword">false</span>;
        }

        <span class="comment">// Cek MIME type</span>
        <span class="php-var">$finfo</span> = <span class="keyword">new</span> <span class="function">finfo</span>(FILEINFO_MIME_TYPE);
        <span class="php-var">$mimeType</span> = <span class="php-var">$finfo</span>-><span class="method">file</span>(<span class="php-var">$file</span>[<span class="string">'tmp_name'</span>]);

        <span class="keyword">if</span> (!<span class="function">in_array</span>(<span class="php-var">$mimeType</span>, <span class="php-var">$this</span>->allowedTypes)) {
            <span class="php-var">$this</span>->errors[] = <span class="string">'Tipe file tidak diizinkan. Allowed: '</span> .
                <span class="function">implode</span>(<span class="string">', '</span>, <span class="php-var">$this</span>->allowedTypes);
            <span class="php-var">$valid</span> = <span class="keyword">false</span>;
        }

        <span class="keyword">return</span> <span class="php-var">$valid</span>;
    }

    <span class="comment">/**
     * Generate nama file unik
     */</span>
    <span class="keyword">private function</span> <span class="method">generateFileName</span>(<span class="php-var">$originalName</span>) {
        <span class="php-var">$extension</span> = <span class="function">strtolower</span>(<span class="function">pathinfo</span>(<span class="php-var">$originalName</span>, PATHINFO_EXTENSION));
        <span class="keyword">return</span> <span class="function">uniqid</span>() . <span class="string">'_'</span> . <span class="function">time</span>() . <span class="string">'.'</span> . <span class="php-var">$extension</span>;
    }

    <span class="comment">/**
     * Hapus file
     */</span>
    <span class="keyword">public function</span> <span class="method">delete</span>(<span class="php-var">$fileName</span>) {
        <span class="php-var">$filePath</span> = <span class="php-var">$this</span>->uploadDir . <span class="php-var">$fileName</span>;
        <span class="keyword">if</span> (<span class="function">file_exists</span>(<span class="php-var">$filePath</span>)) {
            <span class="keyword">return</span> <span class="function">unlink</span>(<span class="php-var">$filePath</span>);
        }
        <span class="keyword">return</span> <span class="keyword">false</span>;
    }

    <span class="comment">/**
     * Format ukuran file ke human readable
     */</span>
    <span class="keyword">public function</span> <span class="method">formatSize</span>(<span class="php-var">$bytes</span>) {
        <span class="php-var">$units</span> = [<span class="string">'B'</span>, <span class="string">'KB'</span>, <span class="string">'MB'</span>, <span class="string">'GB'</span>];
        <span class="php-var">$i</span> = <span class="number">0</span>;
        <span class="keyword">while</span> (<span class="php-var">$bytes</span> >= <span class="number">1024</span> && <span class="php-var">$i</span> < <span class="function">count</span>(<span class="php-var">$units</span>) - <span class="number">1</span>) {
            <span class="php-var">$bytes</span> /= <span class="number">1024</span>;
            <span class="php-var">$i</span>++;
        }
        <span class="keyword">return</span> <span class="function">round</span>(<span class="php-var">$bytes</span>, <span class="number">2</span>) . <span class="string">' '</span> . <span class="php-var">$units</span>[<span class="php-var">$i</span>];
    }

    <span class="comment">/**
     * Dapatkan error messages
     */</span>
    <span class="keyword">public function</span> <span class="method">getErrors</span>() {
        <span class="keyword">return</span> <span class="php-var">$this</span>->errors;
    }

    <span class="comment">/**
     * Pesan error berdasarkan kode
     */</span>
    <span class="keyword">private function</span> <span class="method">getErrorMessage</span>(<span class="php-var">$code</span>) {
        <span class="php-var">$messages</span> = [
            UPLOAD_ERR_INI_SIZE   => <span class="string">'File terlalu besar (limit server)'</span>,
            UPLOAD_ERR_FORM_SIZE  => <span class="string">'File terlalu besar (limit form)'</span>,
            UPLOAD_ERR_PARTIAL    => <span class="string">'File hanya terupload sebagian'</span>,
            UPLOAD_ERR_NO_TMP_DIR => <span class="string">'Folder temporary tidak ditemukan'</span>,
            UPLOAD_ERR_CANT_WRITE => <span class="string">'Gagal menulis file ke disk'</span>,
        ];
        <span class="keyword">return</span> <span class="php-var">$messages</span>[<span class="php-var">$code</span>] ?? <span class="string">'Error upload tidak diketahui'</span>;
    }
}
<span class="tag">?&gt;</span></code>
                </div>

                <div class="page-number">Halaman 5</div>
            </div>

            <!-- PAGE 6: UPDATE MODEL -->
            <div class="page-content">
                <h3 class="subsection-title">2. Update Model Mahasiswa</h3>

                <div class="code-block">
                    <span class="code-label php">models/Mahasiswa.php - Tambah Foto</span>
                    <code><span class="tag">&lt;?php</span>
<span class="keyword">class</span> <span class="function">Mahasiswa</span> {
    <span class="comment">// ... kode sebelumnya ...</span>

    <span class="comment">// CREATE: Simpan data baru dengan foto</span>
    <span class="keyword">public function</span> <span class="method">create</span>(<span class="php-var">$data</span>) {
        <span class="php-var">$sql</span> = <span class="string">"INSERT INTO mahasiswa (nim, nama, email, jurusan, foto)
                VALUES (?, ?, ?, ?, ?)"</span>;
        <span class="php-var">$stmt</span> = <span class="php-var">$this</span>->pdo-><span class="method">prepare</span>(<span class="php-var">$sql</span>);
        <span class="keyword">return</span> <span class="php-var">$stmt</span>-><span class="method">execute</span>([
            <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'nim'</span>]),
            <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'nama'</span>]),
            <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'email'</span>]),
            <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'jurusan'</span>]),
            <span class="php-var">$data</span>[<span class="string">'foto'</span>] ?? <span class="keyword">null</span>  <span class="comment">// Foto bisa null</span>
        ]);
    }

    <span class="comment">// UPDATE: Perbarui data dengan foto</span>
    <span class="keyword">public function</span> <span class="method">update</span>(<span class="php-var">$id</span>, <span class="php-var">$data</span>) {
        <span class="comment">// Jika ada foto baru</span>
        <span class="keyword">if</span> (!<span class="function">empty</span>(<span class="php-var">$data</span>[<span class="string">'foto'</span>])) {
            <span class="php-var">$sql</span> = <span class="string">"UPDATE mahasiswa SET nim=?, nama=?, email=?, jurusan=?, foto=?
                    WHERE id=?"</span>;
            <span class="php-var">$params</span> = [
                <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'nim'</span>]),
                <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'nama'</span>]),
                <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'email'</span>]),
                <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'jurusan'</span>]),
                <span class="php-var">$data</span>[<span class="string">'foto'</span>],
                <span class="php-var">$id</span>
            ];
        } <span class="keyword">else</span> {
            <span class="comment">// Tanpa update foto</span>
            <span class="php-var">$sql</span> = <span class="string">"UPDATE mahasiswa SET nim=?, nama=?, email=?, jurusan=?
                    WHERE id=?"</span>;
            <span class="php-var">$params</span> = [
                <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'nim'</span>]),
                <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'nama'</span>]),
                <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'email'</span>]),
                <span class="function">sanitize</span>(<span class="php-var">$data</span>[<span class="string">'jurusan'</span>]),
                <span class="php-var">$id</span>
            ];
        }

        <span class="php-var">$stmt</span> = <span class="php-var">$this</span>->pdo-><span class="method">prepare</span>(<span class="php-var">$sql</span>);
        <span class="keyword">return</span> <span class="php-var">$stmt</span>-><span class="method">execute</span>(<span class="php-var">$params</span>);
    }

    <span class="comment">// Ambil foto berdasarkan ID (untuk hapus saat update/delete)</span>
    <span class="keyword">public function</span> <span class="method">getFoto</span>(<span class="php-var">$id</span>) {
        <span class="php-var">$stmt</span> = <span class="php-var">$this</span>->pdo-><span class="method">prepare</span>(<span class="string">"SELECT foto FROM mahasiswa WHERE id = ?"</span>);
        <span class="php-var">$stmt</span>-><span class="method">execute</span>([<span class="php-var">$id</span>]);
        <span class="php-var">$result</span> = <span class="php-var">$stmt</span>-><span class="method">fetch</span>();
        <span class="keyword">return</span> <span class="php-var">$result</span> ? <span class="php-var">$result</span>[<span class="string">'foto'</span>] : <span class="keyword">null</span>;
    }
}
<span class="tag">?&gt;</span></code>
                </div>

                <div class="page-number">Halaman 6</div>
            </div>

            <!-- PAGE 7: UPDATE CONTROLLER -->
            <div class="page-content">
                <h3 class="subsection-title">3. Update Controller</h3>

                <div class="code-block">
                    <span class="code-label php">controllers/MahasiswaController.php - Handle Upload</span>
                    <code><span class="tag">&lt;?php</span>
<span class="keyword">require_once</span> __DIR__ . <span class="string">'/../includes/FileHandler.php'</span>;

<span class="keyword">class</span> <span class="function">MahasiswaController</span> {
    <span class="keyword">private</span> <span class="php-var">$model</span>;
    <span class="keyword">private</span> <span class="php-var">$fileHandler</span>;

    <span class="keyword">public function</span> <span class="method">__construct</span>() {
        <span class="php-var">$this</span>->model = <span class="keyword">new</span> Mahasiswa();
        <span class="comment">// FileHandler untuk foto mahasiswa</span>
        <span class="php-var">$this</span>->fileHandler = <span class="keyword">new</span> FileHandler(
            <span class="string">'uploads/mahasiswa/'</span>,           <span class="comment">// Folder tujuan</span>
            [<span class="string">'image/jpeg'</span>, <span class="string">'image/png'</span>, <span class="string">'image/gif'</span>], <span class="comment">// Allowed types</span>
            <span class="number">2097152</span>                            <span class="comment">// Max 2MB</span>
        );
    }

    <span class="comment">// STORE: Proses simpan data baru dengan foto</span>
    <span class="keyword">public function</span> <span class="method">store</span>() {
        <span class="keyword">if</span> (<span class="php-var">$_SERVER</span>[<span class="string">'REQUEST_METHOD'</span>] !== <span class="string">'POST'</span>) {
            <span class="php-var">$this</span>-><span class="method">redirect</span>(<span class="string">'?action=index'</span>);
        }

        <span class="comment">// Validasi input teks</span>
        <span class="php-var">$errors</span> = <span class="php-var">$this</span>-><span class="method">validate</span>(<span class="php-var">$_POST</span>);

        <span class="comment">// Handle upload foto</span>
        <span class="php-var">$fotoName</span> = <span class="keyword">null</span>;
        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="php-var">$_FILES</span>[<span class="string">'foto'</span>]) && <span class="php-var">$_FILES</span>[<span class="string">'foto'</span>][<span class="string">'error'</span>] !== UPLOAD_ERR_NO_FILE) {
            <span class="php-var">$fotoName</span> = <span class="php-var">$this</span>->fileHandler-><span class="method">upload</span>(<span class="php-var">$_FILES</span>[<span class="string">'foto'</span>]);

            <span class="keyword">if</span> (!<span class="php-var">$fotoName</span>) {
                <span class="comment">// Gabungkan error upload dengan error validasi</span>
                <span class="php-var">$errors</span> = <span class="function">array_merge</span>(<span class="php-var">$errors</span>, <span class="php-var">$this</span>->fileHandler-><span class="method">getErrors</span>());
            }
        }

        <span class="keyword">if</span> (!<span class="function">empty</span>(<span class="php-var">$errors</span>)) {
            <span class="php-var">$_SESSION</span>[<span class="string">'errors'</span>] = <span class="php-var">$errors</span>;
            <span class="php-var">$_SESSION</span>[<span class="string">'old'</span>] = <span class="php-var">$_POST</span>;
            <span class="php-var">$this</span>-><span class="method">redirect</span>(<span class="string">'?action=create'</span>);
        }

        <span class="comment">// Simpan ke database</span>
        <span class="php-var">$data</span> = <span class="php-var">$_POST</span>;
        <span class="php-var">$data</span>[<span class="string">'foto'</span>] = <span class="php-var">$fotoName</span>;

        <span class="keyword">if</span> (<span class="php-var">$this</span>->model-><span class="method">create</span>(<span class="php-var">$data</span>)) {
            <span class="php-var">$_SESSION</span>[<span class="string">'success'</span>] = <span class="string">'Data berhasil ditambahkan!'</span>;
        } <span class="keyword">else</span> {
            <span class="comment">// Hapus foto jika gagal simpan ke DB</span>
            <span class="keyword">if</span> (<span class="php-var">$fotoName</span>) {
                <span class="php-var">$this</span>->fileHandler-><span class="method">delete</span>(<span class="php-var">$fotoName</span>);
            }
            <span class="php-var">$_SESSION</span>[<span class="string">'error'</span>] = <span class="string">'Gagal menyimpan data!'</span>;
        }
        <span class="php-var">$this</span>-><span class="method">redirect</span>(<span class="string">'?action=index'</span>);
    }

    <span class="comment">// ... lanjut halaman berikutnya</span></code>
                </div>

                <div class="page-number">Halaman 7</div>
            </div>

            <!-- PAGE 8: UPDATE CONTROLLER LANJUTAN -->
            <div class="page-content">
                <h3 class="subsection-title">Controller (Update & Delete dengan Foto)</h3>

                <div class="code-block">
                    <span class="code-label php">MahasiswaController.php (lanjutan)</span>
                    <code>    <span class="comment">// UPDATE: Proses update data dengan foto</span>
    <span class="keyword">public function</span> <span class="method">update</span>(<span class="php-var">$id</span>) {
        <span class="keyword">if</span> (<span class="php-var">$_SERVER</span>[<span class="string">'REQUEST_METHOD'</span>] !== <span class="string">'POST'</span>) {
            <span class="php-var">$this</span>-><span class="method">redirect</span>(<span class="string">'?action=index'</span>);
        }

        <span class="php-var">$errors</span> = <span class="php-var">$this</span>-><span class="method">validate</span>(<span class="php-var">$_POST</span>, <span class="php-var">$id</span>);
        <span class="php-var">$fotoName</span> = <span class="keyword">null</span>;

        <span class="comment">// Handle upload foto baru</span>
        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="php-var">$_FILES</span>[<span class="string">'foto'</span>]) && <span class="php-var">$_FILES</span>[<span class="string">'foto'</span>][<span class="string">'error'</span>] !== UPLOAD_ERR_NO_FILE) {
            <span class="php-var">$fotoName</span> = <span class="php-var">$this</span>->fileHandler-><span class="method">upload</span>(<span class="php-var">$_FILES</span>[<span class="string">'foto'</span>]);

            <span class="keyword">if</span> (!<span class="php-var">$fotoName</span>) {
                <span class="php-var">$errors</span> = <span class="function">array_merge</span>(<span class="php-var">$errors</span>, <span class="php-var">$this</span>->fileHandler-><span class="method">getErrors</span>());
            }
        }

        <span class="keyword">if</span> (!<span class="function">empty</span>(<span class="php-var">$errors</span>)) {
            <span class="php-var">$_SESSION</span>[<span class="string">'errors'</span>] = <span class="php-var">$errors</span>;
            <span class="php-var">$_SESSION</span>[<span class="string">'old'</span>] = <span class="php-var">$_POST</span>;
            <span class="php-var">$this</span>-><span class="method">redirect</span>(<span class="string">"?action=edit&id={<span class="php-var">$id</span>}"</span>);
        }

        <span class="comment">// Jika ada foto baru, hapus foto lama</span>
        <span class="keyword">if</span> (<span class="php-var">$fotoName</span>) {
            <span class="php-var">$oldFoto</span> = <span class="php-var">$this</span>->model-><span class="method">getFoto</span>(<span class="php-var">$id</span>);
            <span class="keyword">if</span> (<span class="php-var">$oldFoto</span>) {
                <span class="php-var">$this</span>->fileHandler-><span class="method">delete</span>(<span class="php-var">$oldFoto</span>);
            }
        }

        <span class="php-var">$data</span> = <span class="php-var">$_POST</span>;
        <span class="php-var">$data</span>[<span class="string">'foto'</span>] = <span class="php-var">$fotoName</span>;

        <span class="keyword">if</span> (<span class="php-var">$this</span>->model-><span class="method">update</span>(<span class="php-var">$id</span>, <span class="php-var">$data</span>)) {
            <span class="php-var">$_SESSION</span>[<span class="string">'success'</span>] = <span class="string">'Data berhasil diperbarui!'</span>;
        } <span class="keyword">else</span> {
            <span class="php-var">$_SESSION</span>[<span class="string">'error'</span>] = <span class="string">'Gagal memperbarui data!'</span>;
        }
        <span class="php-var">$this</span>-><span class="method">redirect</span>(<span class="string">'?action=index'</span>);
    }

    <span class="comment">// DESTROY: Hapus data beserta fotonya</span>
    <span class="keyword">public function</span> <span class="method">destroy</span>(<span class="php-var">$id</span>) {
        <span class="comment">// Hapus foto terlebih dahulu</span>
        <span class="php-var">$foto</span> = <span class="php-var">$this</span>->model-><span class="method">getFoto</span>(<span class="php-var">$id</span>);
        <span class="keyword">if</span> (<span class="php-var">$foto</span>) {
            <span class="php-var">$this</span>->fileHandler-><span class="method">delete</span>(<span class="php-var">$foto</span>);
        }

        <span class="comment">// Hapus data dari database</span>
        <span class="keyword">if</span> (<span class="php-var">$this</span>->model-><span class="method">delete</span>(<span class="php-var">$id</span>)) {
            <span class="php-var">$_SESSION</span>[<span class="string">'success'</span>] = <span class="string">'Data berhasil dihapus!'</span>;
        } <span class="keyword">else</span> {
            <span class="php-var">$_SESSION</span>[<span class="string">'error'</span>] = <span class="string">'Gagal menghapus data!'</span>;
        }
        <span class="php-var">$this</span>-><span class="method">redirect</span>(<span class="string">'?action=index'</span>);
    }
}
<span class="tag">?&gt;</span></code>
                </div>

                <div class="page-number">Halaman 8</div>
            </div>

            <!-- PAGE 9: VIEW FORM UPLOAD -->
            <div class="page-content">
                <h3 class="subsection-title">4. View - Form dengan Upload</h3>

                <div class="code-block">
                    <span class="code-label">views/mahasiswa/create.php - Form Upload</span>
                    <code><span class="tag">&lt;?php</span> <span class="php-var">$old</span> = <span class="php-var">$_SESSION</span>[<span class="string">'old'</span>] ?? []; <span class="keyword">unset</span>(<span class="php-var">$_SESSION</span>[<span class="string">'old'</span>]); <span class="tag">?&gt;</span>

<span class="tag">&lt;h2</span> <span class="attr">class</span>=<span class="value">"mb-4"</span><span class="tag">&gt;</span>Tambah Mahasiswa<span class="tag">&lt;/h2&gt;</span>

<span class="comment">&lt;!-- PENTING: enctype untuk upload file --&gt;</span>
<span class="tag">&lt;form</span> <span class="attr">action</span>=<span class="value">"?action=store"</span> <span class="attr">method</span>=<span class="value">"POST"</span> <span class="attr">enctype</span>=<span class="value">"multipart/form-data"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"row"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"col-md-8"</span><span class="tag">&gt;</span>
            <span class="comment">&lt;!-- Input fields seperti biasa --&gt;</span>
            <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"mb-3"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;label</span> <span class="attr">class</span>=<span class="value">"form-label"</span><span class="tag">&gt;</span>NIM <span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="value">"text-danger"</span><span class="tag">&gt;</span>*<span class="tag">&lt;/span&gt;&lt;/label&gt;</span>
                <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"text"</span> <span class="attr">name</span>=<span class="value">"nim"</span> <span class="attr">class</span>=<span class="value">"form-control"</span>
                       <span class="attr">value</span>=<span class="value">"&lt;?= htmlspecialchars($old['nim'] ?? '') ?&gt;"</span> <span class="attr">required</span><span class="tag">&gt;</span>
            <span class="tag">&lt;/div&gt;</span>
            <span class="comment">&lt;!-- ... input lainnya ... --&gt;</span>
        <span class="tag">&lt;/div&gt;</span>

        <span class="comment">&lt;!-- Kolom Upload Foto --&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"col-md-4"</span><span class="tag">&gt;</span>
            <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"mb-3"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;label</span> <span class="attr">class</span>=<span class="value">"form-label"</span><span class="tag">&gt;</span>Foto<span class="tag">&lt;/label&gt;</span>
                <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"file"</span> <span class="attr">name</span>=<span class="value">"foto"</span> <span class="attr">class</span>=<span class="value">"form-control"</span>
                       <span class="attr">accept</span>=<span class="value">"image/jpeg,image/png,image/gif"</span>
                       <span class="attr">id</span>=<span class="value">"inputFoto"</span> <span class="attr">onchange</span>=<span class="value">"previewImage(this)"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;small</span> <span class="attr">class</span>=<span class="value">"text-muted"</span><span class="tag">&gt;</span>
                    Format: JPG, PNG, GIF. Maks: 2MB
                <span class="tag">&lt;/small&gt;</span>

                <span class="comment">&lt;!-- Preview Gambar --&gt;</span>
                <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"mt-3 text-center"</span><span class="tag">&gt;</span>
                    <span class="tag">&lt;img</span> <span class="attr">id</span>=<span class="value">"preview"</span> <span class="attr">src</span>=<span class="value">""</span> <span class="attr">alt</span>=<span class="value">"Preview"</span>
                         <span class="attr">class</span>=<span class="value">"img-thumbnail"</span>
                         <span class="attr">style</span>=<span class="value">"max-width: 200px; display: none;"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;/div&gt;</span>
            <span class="tag">&lt;/div&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>

    <span class="tag">&lt;button</span> <span class="attr">type</span>=<span class="value">"submit"</span> <span class="attr">class</span>=<span class="value">"btn btn-primary"</span><span class="tag">&gt;</span>Simpan<span class="tag">&lt;/button&gt;</span>
    <span class="tag">&lt;a</span> <span class="attr">href</span>=<span class="value">"?action=index"</span> <span class="attr">class</span>=<span class="value">"btn btn-secondary"</span><span class="tag">&gt;</span>Batal<span class="tag">&lt;/a&gt;</span>
<span class="tag">&lt;/form&gt;</span>

<span class="tag">&lt;script&gt;</span>
<span class="comment">// Preview gambar sebelum upload</span>
<span class="js-keyword">function</span> <span class="js-func">previewImage</span>(input) {
    <span class="js-keyword">const</span> preview = document.<span class="js-func">getElementById</span>(<span class="js-string">'preview'</span>);
    <span class="js-keyword">if</span> (input.files && input.files[<span class="number">0</span>]) {
        <span class="js-keyword">const</span> reader = <span class="js-keyword">new</span> FileReader();
        reader.<span class="js-func">onload</span> = <span class="js-keyword">function</span>(e) {
            preview.src = e.target.result;
            preview.style.display = <span class="js-string">'block'</span>;
        }
        reader.<span class="js-func">readAsDataURL</span>(input.files[<span class="number">0</span>]);
    }
}
<span class="tag">&lt;/script&gt;</span></code>
                </div>

                <div class="page-number">Halaman 9</div>
            </div>

            <!-- PAGE 10: VIEW EDIT WITH IMAGE -->
            <div class="page-content">
                <h3 class="subsection-title">View - Form Edit dengan Foto</h3>

                <div class="code-block">
                    <span class="code-label">views/mahasiswa/edit.php - Edit Upload</span>
                    <code><span class="tag">&lt;h2</span> <span class="attr">class</span>=<span class="value">"mb-4"</span><span class="tag">&gt;</span>Edit Mahasiswa<span class="tag">&lt;/h2&gt;</span>

<span class="tag">&lt;form</span> <span class="attr">action</span>=<span class="value">"?action=update&id=&lt;?= $mahasiswa['id'] ?&gt;"</span> <span class="attr">method</span>=<span class="value">"POST"</span>
      <span class="attr">enctype</span>=<span class="value">"multipart/form-data"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"row"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"col-md-8"</span><span class="tag">&gt;</span>
            <span class="comment">&lt;!-- Input fields dengan value dari database --&gt;</span>
            <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"mb-3"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;label</span> <span class="attr">class</span>=<span class="value">"form-label"</span><span class="tag">&gt;</span>NIM<span class="tag">&lt;/label&gt;</span>
                <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"text"</span> <span class="attr">name</span>=<span class="value">"nim"</span> <span class="attr">class</span>=<span class="value">"form-control"</span>
                       <span class="attr">value</span>=<span class="value">"&lt;?= htmlspecialchars($mahasiswa['nim']) ?&gt;"</span><span class="tag">&gt;</span>
            <span class="tag">&lt;/div&gt;</span>
            <span class="comment">&lt;!-- ... input lainnya ... --&gt;</span>
        <span class="tag">&lt;/div&gt;</span>

        <span class="comment">&lt;!-- Kolom Foto --&gt;</span>
        <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"col-md-4"</span><span class="tag">&gt;</span>
            <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"mb-3"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;label</span> <span class="attr">class</span>=<span class="value">"form-label"</span><span class="tag">&gt;</span>Foto<span class="tag">&lt;/label&gt;</span>

                <span class="comment">&lt;!-- Tampilkan foto saat ini --&gt;</span>
                <span class="tag">&lt;?php</span> <span class="keyword">if</span> (!<span class="function">empty</span>(<span class="php-var">$mahasiswa</span>[<span class="string">'foto'</span>])): <span class="tag">?&gt;</span>
                <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"mb-2 text-center"</span><span class="tag">&gt;</span>
                    <span class="tag">&lt;img</span> <span class="attr">src</span>=<span class="value">"uploads/mahasiswa/&lt;?= $mahasiswa['foto'] ?&gt;"</span>
                         <span class="attr">alt</span>=<span class="value">"Foto saat ini"</span> <span class="attr">class</span>=<span class="value">"img-thumbnail"</span>
                         <span class="attr">style</span>=<span class="value">"max-width: 150px;"</span><span class="tag">&gt;</span>
                    <span class="tag">&lt;p</span> <span class="attr">class</span>=<span class="value">"text-muted small"</span><span class="tag">&gt;</span>Foto saat ini<span class="tag">&lt;/p&gt;</span>
                <span class="tag">&lt;/div&gt;</span>
                <span class="tag">&lt;?php</span> <span class="keyword">endif</span>; <span class="tag">?&gt;</span>

                <span class="tag">&lt;input</span> <span class="attr">type</span>=<span class="value">"file"</span> <span class="attr">name</span>=<span class="value">"foto"</span> <span class="attr">class</span>=<span class="value">"form-control"</span>
                       <span class="attr">accept</span>=<span class="value">"image/jpeg,image/png,image/gif"</span>
                       <span class="attr">onchange</span>=<span class="value">"previewImage(this)"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;small</span> <span class="attr">class</span>=<span class="value">"text-muted"</span><span class="tag">&gt;</span>
                    Kosongkan jika tidak ingin mengubah foto
                <span class="tag">&lt;/small&gt;</span>

                <span class="comment">&lt;!-- Preview foto baru --&gt;</span>
                <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"mt-2 text-center"</span><span class="tag">&gt;</span>
                    <span class="tag">&lt;img</span> <span class="attr">id</span>=<span class="value">"preview"</span> <span class="attr">src</span>=<span class="value">""</span> <span class="attr">alt</span>=<span class="value">"Preview"</span>
                         <span class="attr">class</span>=<span class="value">"img-thumbnail"</span>
                         <span class="attr">style</span>=<span class="value">"max-width: 150px; display: none;"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;/div&gt;</span>
            <span class="tag">&lt;/div&gt;</span>
        <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/div&gt;</span>

    <span class="tag">&lt;button</span> <span class="attr">type</span>=<span class="value">"submit"</span> <span class="attr">class</span>=<span class="value">"btn btn-primary"</span><span class="tag">&gt;</span>Update<span class="tag">&lt;/button&gt;</span>
    <span class="tag">&lt;a</span> <span class="attr">href</span>=<span class="value">"?action=index"</span> <span class="attr">class</span>=<span class="value">"btn btn-secondary"</span><span class="tag">&gt;</span>Batal<span class="tag">&lt;/a&gt;</span>
<span class="tag">&lt;/form&gt;</span></code>
                </div>

                <div class="page-number">Halaman 10</div>
            </div>

            <!-- PAGE 11: VIEW INDEX WITH FOTO -->
            <div class="page-content">
                <h3 class="subsection-title">View - Tabel dengan Foto</h3>

                <div class="code-block">
                    <span class="code-label">views/mahasiswa/index.php - Tampilkan Foto</span>
                    <code><span class="tag">&lt;table</span> <span class="attr">class</span>=<span class="value">"table table-striped table-hover"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;thead</span> <span class="attr">class</span>=<span class="value">"table-dark"</span><span class="tag">&gt;</span>
        <span class="tag">&lt;tr&gt;</span>
            <span class="tag">&lt;th&gt;</span>No<span class="tag">&lt;/th&gt;</span>
            <span class="tag">&lt;th&gt;</span>Foto<span class="tag">&lt;/th&gt;</span>
            <span class="tag">&lt;th&gt;</span>NIM<span class="tag">&lt;/th&gt;</span>
            <span class="tag">&lt;th&gt;</span>Nama<span class="tag">&lt;/th&gt;</span>
            <span class="tag">&lt;th&gt;</span>Email<span class="tag">&lt;/th&gt;</span>
            <span class="tag">&lt;th&gt;</span>Jurusan<span class="tag">&lt;/th&gt;</span>
            <span class="tag">&lt;th&gt;</span>Aksi<span class="tag">&lt;/th&gt;</span>
        <span class="tag">&lt;/tr&gt;</span>
    <span class="tag">&lt;/thead&gt;</span>
    <span class="tag">&lt;tbody&gt;</span>
        <span class="tag">&lt;?php</span> <span class="keyword">foreach</span> (<span class="php-var">$mahasiswa</span> <span class="keyword">as</span> <span class="php-var">$i</span> => <span class="php-var">$mhs</span>): <span class="tag">?&gt;</span>
        <span class="tag">&lt;tr&gt;</span>
            <span class="tag">&lt;td&gt;&lt;?=</span> <span class="php-var">$i</span> + <span class="number">1</span> <span class="tag">?&gt;&lt;/td&gt;</span>
            <span class="tag">&lt;td&gt;</span>
                <span class="tag">&lt;?php</span> <span class="keyword">if</span> (!<span class="function">empty</span>(<span class="php-var">$mhs</span>[<span class="string">'foto'</span>])): <span class="tag">?&gt;</span>
                    <span class="tag">&lt;img</span> <span class="attr">src</span>=<span class="value">"uploads/mahasiswa/&lt;?= htmlspecialchars($mhs['foto']) ?&gt;"</span>
                         <span class="attr">alt</span>=<span class="value">"Foto"</span> <span class="attr">class</span>=<span class="value">"rounded-circle"</span>
                         <span class="attr">style</span>=<span class="value">"width: 40px; height: 40px; object-fit: cover;"</span><span class="tag">&gt;</span>
                <span class="tag">&lt;?php</span> <span class="keyword">else</span>: <span class="tag">?&gt;</span>
                    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="value">"rounded-circle bg-secondary d-flex
                              align-items-center justify-content-center text-white"</span>
                         <span class="attr">style</span>=<span class="value">"width: 40px; height: 40px;"</span><span class="tag">&gt;</span>
                        <span class="tag">&lt;?=</span> <span class="function">strtoupper</span>(<span class="function">substr</span>(<span class="php-var">$mhs</span>[<span class="string">'nama'</span>], <span class="number">0</span>, <span class="number">1</span>)) <span class="tag">?&gt;</span>
                    <span class="tag">&lt;/div&gt;</span>
                <span class="tag">&lt;?php</span> <span class="keyword">endif</span>; <span class="tag">?&gt;</span>
            <span class="tag">&lt;/td&gt;</span>
            <span class="tag">&lt;td&gt;&lt;?=</span> <span class="function">htmlspecialchars</span>(<span class="php-var">$mhs</span>[<span class="string">'nim'</span>]) <span class="tag">?&gt;&lt;/td&gt;</span>
            <span class="tag">&lt;td&gt;&lt;?=</span> <span class="function">htmlspecialchars</span>(<span class="php-var">$mhs</span>[<span class="string">'nama'</span>]) <span class="tag">?&gt;&lt;/td&gt;</span>
            <span class="tag">&lt;td&gt;&lt;?=</span> <span class="function">htmlspecialchars</span>(<span class="php-var">$mhs</span>[<span class="string">'email'</span>]) <span class="tag">?&gt;&lt;/td&gt;</span>
            <span class="tag">&lt;td&gt;&lt;?=</span> <span class="function">htmlspecialchars</span>(<span class="php-var">$mhs</span>[<span class="string">'jurusan'</span>]) <span class="tag">?&gt;&lt;/td&gt;</span>
            <span class="tag">&lt;td&gt;</span>
                <span class="tag">&lt;a</span> <span class="attr">href</span>=<span class="value">"?action=show&id=&lt;?= $mhs['id'] ?&gt;"</span>
                   <span class="attr">class</span>=<span class="value">"btn btn-info btn-sm"</span><span class="tag">&gt;</span>Detail<span class="tag">&lt;/a&gt;</span>
                <span class="tag">&lt;a</span> <span class="attr">href</span>=<span class="value">"?action=edit&id=&lt;?= $mhs['id'] ?&gt;"</span>
                   <span class="attr">class</span>=<span class="value">"btn btn-warning btn-sm"</span><span class="tag">&gt;</span>Edit<span class="tag">&lt;/a&gt;</span>
                <span class="tag">&lt;a</span> <span class="attr">href</span>=<span class="value">"?action=destroy&id=&lt;?= $mhs['id'] ?&gt;"</span>
                   <span class="attr">class</span>=<span class="value">"btn btn-danger btn-sm"</span>
                   <span class="attr">onclick</span>=<span class="value">"return confirm('Yakin hapus?')"</span><span class="tag">&gt;</span>Hapus<span class="tag">&lt;/a&gt;</span>
            <span class="tag">&lt;/td&gt;</span>
        <span class="tag">&lt;/tr&gt;</span>
        <span class="tag">&lt;?php</span> <span class="keyword">endforeach</span>; <span class="tag">?&gt;</span>
    <span class="tag">&lt;/tbody&gt;</span>
<span class="tag">&lt;/table&gt;</span></code>
                </div>

                <div class="info-box">
                    <strong>&#128161; Tip:</strong> Gunakan <code>object-fit: cover</code> agar gambar tidak terdistorsi saat ditampilkan dalam ukuran tetap.
                </div>

                <div class="page-number">Halaman 11</div>
            </div>

            <!-- PAGE 12: DOWNLOAD FILE -->
            <div class="page-content">
                <h2 class="section-title">&#128229; DOWNLOAD FILE</h2>

                <h3 class="subsection-title">Cara Download File yang Aman</h3>

                <div class="code-block">
                    <span class="code-label php">download.php - Secure Download</span>
                    <code><span class="tag">&lt;?php</span>
<span class="function">session_start</span>();
<span class="keyword">require_once</span> <span class="string">'includes/auth.php'</span>;
<span class="function">requireLogin</span>(); <span class="comment">// Pastikan sudah login</span>

<span class="comment">// Ambil nama file dari parameter</span>
<span class="php-var">$file</span> = <span class="php-var">$_GET</span>[<span class="string">'file'</span>] ?? <span class="string">''</span>;

<span class="comment">// VALIDASI: Cegah directory traversal attack</span>
<span class="php-var">$file</span> = <span class="function">basename</span>(<span class="php-var">$file</span>); <span class="comment">// Hapus path, ambil nama file saja</span>

<span class="comment">// Path lengkap ke file</span>
<span class="php-var">$filePath</span> = <span class="string">'uploads/documents/'</span> . <span class="php-var">$file</span>;

<span class="comment">// Cek apakah file ada</span>
<span class="keyword">if</span> (!<span class="function">file_exists</span>(<span class="php-var">$filePath</span>)) {
    <span class="function">header</span>(<span class="string">'HTTP/1.0 404 Not Found'</span>);
    <span class="keyword">die</span>(<span class="string">'File tidak ditemukan'</span>);
}

<span class="comment">// Cek apakah benar-benar file (bukan folder)</span>
<span class="keyword">if</span> (!<span class="function">is_file</span>(<span class="php-var">$filePath</span>)) {
    <span class="function">header</span>(<span class="string">'HTTP/1.0 403 Forbidden'</span>);
    <span class="keyword">die</span>(<span class="string">'Akses ditolak'</span>);
}

<span class="comment">// Dapatkan informasi file</span>
<span class="php-var">$fileSize</span> = <span class="function">filesize</span>(<span class="php-var">$filePath</span>);
<span class="php-var">$fileName</span> = <span class="function">basename</span>(<span class="php-var">$filePath</span>);
<span class="php-var">$mimeType</span> = <span class="function">mime_content_type</span>(<span class="php-var">$filePath</span>);

<span class="comment">// Set headers untuk download</span>
<span class="function">header</span>(<span class="string">'Content-Description: File Transfer'</span>);
<span class="function">header</span>(<span class="string">'Content-Type: '</span> . <span class="php-var">$mimeType</span>);
<span class="function">header</span>(<span class="string">'Content-Disposition: attachment; filename="'</span> . <span class="php-var">$fileName</span> . <span class="string">'"'</span>);
<span class="function">header</span>(<span class="string">'Content-Length: '</span> . <span class="php-var">$fileSize</span>);
<span class="function">header</span>(<span class="string">'Pragma: public'</span>);
<span class="function">header</span>(<span class="string">'Cache-Control: must-revalidate'</span>);

<span class="comment">// Bersihkan output buffer</span>
<span class="function">ob_clean</span>();
<span class="function">flush</span>();

<span class="comment">// Kirim file ke browser</span>
<span class="function">readfile</span>(<span class="php-var">$filePath</span>);
<span class="keyword">exit</span>;
<span class="tag">?&gt;</span></code>
                </div>

                <div class="danger-box">
                    <strong>Keamanan Download:</strong>
                    <ul style="margin-top: 8px; margin-left: 15px;">
                        <li>Selalu gunakan <code>basename()</code> untuk mencegah directory traversal</li>
                        <li>Jangan izinkan akses langsung ke folder uploads</li>
                        <li>Validasi hak akses user terhadap file</li>
                    </ul>
                </div>

                <div class="page-number">Halaman 12</div>
            </div>

            <!-- PAGE 13: LINK DOWNLOAD -->
            <div class="page-content">
                <h3 class="subsection-title">Membuat Link Download</h3>

                <div class="code-block">
                    <span class="code-label">Contoh Link Download di View</span>
                    <code><span class="comment">&lt;!-- Download via PHP (lebih aman) --&gt;</span>
<span class="tag">&lt;a</span> <span class="attr">href</span>=<span class="value">"download.php?file=&lt;?= urlencode($dokumen['nama_file']) ?&gt;"</span>
   <span class="attr">class</span>=<span class="value">"btn btn-primary btn-sm"</span><span class="tag">&gt;</span>
    &#128229; Download
<span class="tag">&lt;/a&gt;</span>

<span class="comment">&lt;!-- Download langsung (untuk file publik) --&gt;</span>
<span class="tag">&lt;a</span> <span class="attr">href</span>=<span class="value">"uploads/documents/&lt;?= $dokumen['nama_file'] ?&gt;"</span>
   <span class="attr">download</span>=<span class="value">"&lt;?= $dokumen['nama_asli'] ?&gt;"</span>
   <span class="attr">class</span>=<span class="value">"btn btn-outline-primary btn-sm"</span><span class="tag">&gt;</span>
    &#128229; Download
<span class="tag">&lt;/a&gt;</span>

<span class="comment">&lt;!-- Preview gambar di modal --&gt;</span>
<span class="tag">&lt;a</span> <span class="attr">href</span>=<span class="value">"#"</span> <span class="attr">data-bs-toggle</span>=<span class="value">"modal"</span> <span class="attr">data-bs-target</span>=<span class="value">"#modalFoto&lt;?= $mhs['id'] ?&gt;"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;img</span> <span class="attr">src</span>=<span class="value">"uploads/mahasiswa/&lt;?= $mhs['foto'] ?&gt;"</span>
         <span class="attr">class</span>=<span class="value">"img-thumbnail"</span> <span class="attr">style</span>=<span class="value">"width: 50px;"</span><span class="tag">&gt;</span>
<span class="tag">&lt;/a&gt;</span></code>
                </div>

                <h3 class="subsection-title">Fungsi File Lainnya</h3>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Fungsi</th><th>Kegunaan</th><th>Contoh</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>file_exists()</code></td>
                                <td>Cek file/folder ada</td>
                                <td><code>file_exists('file.jpg')</code></td>
                            </tr>
                            <tr>
                                <td><code>is_file()</code></td>
                                <td>Cek apakah file</td>
                                <td><code>is_file('file.jpg')</code></td>
                            </tr>
                            <tr>
                                <td><code>is_dir()</code></td>
                                <td>Cek apakah folder</td>
                                <td><code>is_dir('uploads')</code></td>
                            </tr>
                            <tr>
                                <td><code>filesize()</code></td>
                                <td>Ukuran file (bytes)</td>
                                <td><code>filesize('file.jpg')</code></td>
                            </tr>
                            <tr>
                                <td><code>unlink()</code></td>
                                <td>Hapus file</td>
                                <td><code>unlink('file.jpg')</code></td>
                            </tr>
                            <tr>
                                <td><code>rename()</code></td>
                                <td>Rename/pindah file</td>
                                <td><code>rename('old.jpg', 'new.jpg')</code></td>
                            </tr>
                            <tr>
                                <td><code>copy()</code></td>
                                <td>Copy file</td>
                                <td><code>copy('src.jpg', 'dest.jpg')</code></td>
                            </tr>
                            <tr>
                                <td><code>mkdir()</code></td>
                                <td>Buat folder</td>
                                <td><code>mkdir('folder', 0755, true)</code></td>
                            </tr>
                            <tr>
                                <td><code>pathinfo()</code></td>
                                <td>Info path file</td>
                                <td><code>pathinfo('file.jpg', PATHINFO_EXTENSION)</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="page-number">Halaman 13</div>
            </div>

            <!-- PAGE 14: KEAMANAN FILE UPLOAD -->
            <div class="page-content">
                <h2 class="section-title">&#128737; KEAMANAN FILE UPLOAD</h2>

                <div class="danger-box">
                    <strong>Risiko Keamanan Upload:</strong>
                    <ul style="margin-top: 10px; margin-left: 15px;">
                        <li><strong>Malicious File:</strong> Upload file PHP/script yang bisa dieksekusi</li>
                        <li><strong>File Overwrite:</strong> Menimpa file penting dengan nama sama</li>
                        <li><strong>Directory Traversal:</strong> Akses file di luar folder upload</li>
                        <li><strong>DoS Attack:</strong> Upload file sangat besar</li>
                    </ul>
                </div>

                <h3 class="subsection-title">Checklist Keamanan</h3>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Checklist</th><th>Implementasi</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>&#9989; Validasi MIME type</td>
                                <td>Gunakan <code>finfo</code> bukan <code>$_FILES['type']</code></td>
                            </tr>
                            <tr>
                                <td>&#9989; Batasi ukuran file</td>
                                <td>Cek <code>$_FILES['size']</code> sebelum proses</td>
                            </tr>
                            <tr>
                                <td>&#9989; Rename file</td>
                                <td>Gunakan nama unik (<code>uniqid()</code>)</td>
                            </tr>
                            <tr>
                                <td>&#9989; Simpan di luar webroot</td>
                                <td>Atau gunakan <code>.htaccess</code> untuk blokir eksekusi</td>
                            </tr>
                            <tr>
                                <td>&#9989; Validasi ekstensi</td>
                                <td>Whitelist ekstensi yang diizinkan</td>
                            </tr>
                            <tr>
                                <td>&#9989; Gunakan <code>move_uploaded_file()</code></td>
                                <td>Bukan <code>copy()</code> atau <code>rename()</code></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="subsection-title">Blokir Eksekusi di Folder Upload</h3>

                <div class="code-block">
                    <span class="code-label">uploads/.htaccess</span>
                    <code><span class="comment"># Blokir eksekusi script di folder ini</span>
<span class="keyword">php_flag</span> engine off

<span class="comment"># Atau dengan cara lain:</span>
<span class="tag">&lt;FilesMatch</span> <span class="value">"\.(php|phtml|php3|php4|php5|phps)$"</span><span class="tag">&gt;</span>
    <span class="keyword">Deny from all</span>
<span class="tag">&lt;/FilesMatch&gt;</span>

<span class="comment"># Hanya izinkan file gambar</span>
<span class="tag">&lt;FilesMatch</span> <span class="value">"\.(jpg|jpeg|png|gif|pdf|doc|docx)$"</span><span class="tag">&gt;</span>
    <span class="keyword">Allow from all</span>
<span class="tag">&lt;/FilesMatch&gt;</span></code>
                </div>

                <div class="success-box">
                    <strong>Tip:</strong> Untuk keamanan maksimal, simpan file di folder yang tidak bisa diakses langsung via URL, lalu gunakan script PHP untuk serve file dengan validasi akses.
                </div>

                <div class="page-number">Halaman 14</div>
            </div>

            <!-- PAGE 15: TUGAS -->
            <div class="page-content">
                <h2 class="section-title">&#128203; TUGAS PRAKTIKUM</h2>

                <div class="project-card">
                    <h3>&#9989; Tugas: Implementasi File Upload</h3>
                    <p style="margin-bottom: 15px;">Implementasikan fitur upload file pada <strong>project masing-masing</strong>:</p>
                    <ol style="margin-left: 20px; line-height: 2.2;">
                        <li>Buat class <code>FileHandler.php</code> atau modifikasi sesuai kebutuhan</li>
                        <li>Tambahkan kolom untuk menyimpan nama file di database</li>
                        <li>Implementasi fitur <strong>upload</strong> dengan validasi (tipe, ukuran)</li>
                        <li>Tampilkan <strong>preview gambar</strong> sebelum upload</li>
                        <li>Tampilkan gambar/file yang sudah diupload di halaman list</li>
                        <li>Update fitur <strong>edit</strong> untuk mengganti file</li>
                        <li>Pastikan file lama <strong>terhapus</strong> saat update/delete</li>
                        <li>Implementasi <strong>download</strong> file yang aman</li>
                    </ol>
                </div>

                <h3 class="subsection-title">Kriteria Penilaian</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr><th>Aspek</th><th>Bobot</th><th>Kriteria</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Upload File</td><td>25%</td><td>Berhasil upload dengan validasi</td></tr>
                            <tr><td>Validasi</td><td>20%</td><td>Cek tipe, ukuran, ekstensi</td></tr>
                            <tr><td>Preview</td><td>10%</td><td>Preview gambar sebelum upload</td></tr>
                            <tr><td>Tampilkan File</td><td>15%</td><td>Gambar muncul di list/detail</td></tr>
                            <tr><td>Update/Delete</td><td>15%</td><td>File lama terhapus dengan benar</td></tr>
                            <tr><td>Keamanan</td><td>15%</td><td>Rename file, blokir eksekusi</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="warning-box" style="margin-top: 25px;">
                    <strong>&#128679; Contoh Implementasi:</strong>
                    <ul style="margin-top: 8px; margin-left: 15px;">
                        <li><strong>Toko Online:</strong> Upload foto produk</li>
                        <li><strong>Perpustakaan:</strong> Upload cover buku, file e-book</li>
                        <li><strong>E-Voting:</strong> Upload foto kandidat</li>
                        <li><strong>Inventaris:</strong> Upload foto barang</li>
                    </ul>
                </div>

                <div style="margin-top: 40px; padding: 30px; background: #f8f9fa; border-radius: 15px; border-left: 5px solid #ff9800;">
                    <h3 style="color: #e65100; margin-bottom: 15px;">&#128231; Contact Information</h3>
                    <p><strong>Dosen:</strong> Ikhwan Alfath Nurul Fathony, S.Kom., M.Kom.</p>
                    <p><strong>Email:</strong> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="50393b3827313e7e313c3631243810253e24393431227e31337e3934">[email&#160;protected]</a></p>
                </div>

                <div style="margin-top: 30px; font-size: 0.9em; color: #888; text-align: center;">
                    <p>&copy; 2025 Program Studi Teknologi Informasi - Universitas Tidar</p>
                </div>

                <div class="page-number">Halaman 15</div>
            </div>

        </div>
    </div>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }
        function scrollToBottom() { window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' }); }
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Home') { e.preventDefault(); scrollToTop(); }
            if (e.key === 'End') { e.preventDefault(); scrollToBottom(); }
        });
    </script>
</body>
</html>
